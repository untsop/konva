<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>KonvaJS Image Mask Sandbox</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        margin: 0;
        width: 100vw;
        height: 100vh;
        display: flex;
        flex-direction: row;
      }
      #container1,
      #container2 {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <div id="container1"></div>
    <div id="container2"></div>

    <script type="module">
      import Konva from '../src/index.ts';

      const width = window.innerWidth / 2;
      const height = window.innerHeight;

      function loadImage(url) {
        return new Promise((resolve) => {
          const img = new window.Image();
          img.crossOrigin = 'Anonymous';
          img.onload = () => resolve(img);
          img.src = url;
        });
      }

      (async () => {
        const img = await loadImage('https://konvajs.org/assets/yoda.gif');

        // Example 1: simple stroke mask
        const stage1 = new Konva.Stage({
          container: 'container1',
          width,
          height,
        });
        const layer1 = new Konva.Layer();
        stage1.add(layer1);

        const image1 = new Konva.Image({
          image: img,
          x: 20,
          y: 20,
          width: 300,
          height: 300,
          maskStrokes: [
            {
              points: [0, 150, 300, 150],
              strokeWidth: 50,
            },
            {
              points: [150, 0, 150, 300],
              strokeWidth: 50,
            },
          ],
        });
        layer1.add(image1);

        // Example 2: closed cut mask
        const stage2 = new Konva.Stage({
          container: 'container2',
          width,
          height,
        });
        const layer2 = new Konva.Layer();
        stage2.add(layer2);

        const image2 = new Konva.Image({
          image: img,
          x: 20,
          y: 20,
          width: 300,
          height: 300,
          // Three erasing strokes forming U-shape; right edge of image completes the rectangle
          maskStrokes: [
            {
              // U-shape closed with the right edge
              points: [50, 50, 200, 100, 300, 300, 0, 300],
              closed: true,
            },
          ],
          // explicitly set erase mode (currently default)
          maskMode: 'erase',
        });
        layer2.add(image2);
      })();
    </script>
  </body>
</html>
